{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///webpack/bootstrap?","webpack:///webpack/runtime/global?","webpack:///webpack/runtime/publicPath?","webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","/* eslint-disable no-unused-vars */\n/* eslint-disable prettier/prettier */\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n// images references in the manifest\nimport \"../../assets/icon-16.png\";\nimport \"../../assets/icon-32.png\";\nimport \"../../assets/icon-80.png\";\n\n/* global console, document, Excel, Office */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    document.getElementById(\"calculate\").onclick = calculate;\n    document.getElementById(\"reload\").onclick = reload;\n  }\n});\n\n// ACTIVITY TYPE DATA\nvar ActivityTypeDictionary = {\n  \"34\": \"Faz-1 Betonu Dökülmesi\",\n  \"35\": \"Faz-2 Betonu Dökülmesi\",\n  \"08\": \"Rayların Hatta Dağıtılması\",\n  \"38\": \"Panelrayların Serilmesi\",\n  \"41\": \"Grout Dökülmesi\",\n  \"39\": \"Panelrayların Kot ve Eksen Ayarının Yapılması\",\n  \"09\": \"Rayların Hatta Montajı\",\n  \"43\": \"Plinth Beton Dökümü\"\n};\n\n\n// FUNCTIONS\nfunction populateList(listId, arr) {\n  const list = document.getElementById(listId);\n  for (let i = 0; i <= arr.length - 1; i++) {\n    const li = document.createElement(\"li\");\n    li.innerHTML = arr[i];\n    list.appendChild(li);\n  }\n}\n\nfunction findIndex(arr, value) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i] == value) {\n      return i\n    }\n  }\n  return -1\n}\n\nfunction findActivityTypes(columns_arr, data) {\n  let key_column_name = \"WBSADI\"; // ! bu kolon adına göre hareket edecek, önemli.\n  let index = findIndex(columns_arr, key_column_name);\n  const activityTypes = [];\n  for (let i = 0; i < data.length; i++) {\n    var wbsValue = data[i][index];\n    if (wbsValue == key_column_name) {\n      continue; // data'nın ilk satırı kolon başlıklarıysa elemek için.\n    }\n    var activityCode = wbsValue.slice(wbsValue.length - 2, wbsValue.length);\n    if (findIndex(activityTypes, activityCode) == -1) {\n      activityTypes.push(activityCode);\n    }\n  }\n  return activityTypes;\n}\n\nfunction getTheLastX(str, x) {\n   return str.slice(str.length - x, str.length);\n}\n\n// CALCULATE BUTTON\nfunction calculate() {\n  Excel.run(function (context) {\n    var tableName = \"data\";\n    var table = context.workbook.tables.getItem(tableName);\n    var tableRange = table.getRange();\n    tableRange.load([\"rowCount\", \"address\", \"values\"]);\n    var columnsRow = tableRange.getRow(0);\n    columnsRow.load(\"values\");;\n\n    return context.sync().then(\n      function () {\n        document.getElementById(\"tableRange\").innerHTML = tableRange.address;\n\n        var countOfRows = tableRange.rowCount;\n        document.getElementById(\"number_of_rows\").innerHTML = countOfRows;\n\n        var columns = columnsRow.values[0];\n        document.getElementById(\"columns\").innerHTML = \"\";\n        populateList(\"columns\", columns);\n\n        var data = tableRange.values;\n        var activityTypes = findActivityTypes(columnsRow.values[0], data)\n        var tableHTML = document.getElementById(\"results_table\");\n        var x = 1;\n        for (let i of activityTypes) {\n            let row = tableHTML.insertRow(x);\n            row.insertCell(0).innerHTML = i;\n            row.insertCell(1).innerHTML = ActivityTypeDictionary[i];\n            \n            // * realized quantity calculation\n            let quantity = 0;\n            for (let d of data) {\n              // ! kolon isimleri önemli\n              if (getTheLastX(d[findIndex(columns,\"WBSADI\")],2) == i) {\n                quantity = quantity + Number(d[findIndex(columns,\"ILERLEME\")]);\n              }\n            };\n            row.insertCell(2).innerHTML = quantity;\n            \n            // * working hours calculation\n            let workingHours = 0;\n            for (let d of data) {\n              // ! kolon isimleri önemli\n              if (getTheLastX(d[findIndex(columns,\"WBSADI\")],2) == i\n               && d[findIndex(columns,\"ISDETAYI\")] == \"Çalışma\"\n              ) {\n                workingHours = workingHours + Number(d[findIndex(columns,\"CALISMASAATI\")]);\n              }\n            };\n            row.insertCell(3).innerHTML = workingHours;\n            \n            row.insertCell(4).innerHTML = Math.round(quantity / workingHours * 10);\n\n            x++;\n        };\n\n      }\n    ).then(context.sync);\n  })\n    .catch(function (error) {\n      console.log(\"Error: \" + error);\n      // if (error instanceof OfficeExtension.Error) {\n      //     console.log(\"Debug info: \" + JSON.stringify(error.debugInfo));\n      // }\n    });\n}\n\n// var table = document.getElementById(\"results_table\");\n// var row = table.insertRow(2);\n// var cell1 = row.insertCell(0);\n// var cell2 = row.insertCell(1);\n// cell1.innerHTML = \"new cell\";\n// cell2.innerHTML = \"new cell\";\n\n\n// CALCULATE BUTTON\nfunction reload() {\n  Excel.run(function (context) {\n\n    // eslint-disable-next-line no-undef\n    location.reload();\n\n    return context.sync()\n  })\n    .catch(function (error) {\n      console.log(\"Error: \" + error);\n      // if (error instanceof OfficeExtension.Error) {\n      //     console.log(\"Debug info: \" + JSON.stringify(error.debugInfo));\n      // }\n    });\n}"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","g","globalThis","this","Function","e","window","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","Error","replace","p","Office","onReady","info","host","HostType","Excel","getElementById","style","display","onclick","calculate","reload","ActivityTypeDictionary","findIndex","arr","value","i","getTheLastX","str","x","slice","run","context","tableRange","workbook","tables","getItem","getRange","load","columnsRow","getRow","sync","then","innerHTML","address","countOfRows","rowCount","columns","values","listId","list","li","createElement","appendChild","populateList","data","activityTypes","columns_arr","key_column_name","index","wbsValue","activityCode","push","findActivityTypes","tableHTML","row","insertRow","insertCell","quantity","d","Number","workingHours","Math","round","error","console","log"],"sourceRoot":""}